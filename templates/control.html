{% extends "base.html" %}

<!-- 页面标题 -->
{% block PageTitle %} 控制界面 {% endblock %}
{% block AdditionScript %}
     <script src="/statics/js/topInfo.js"></script>
{% endblock %}

{% block titleURL%} /index/ {% endblock %}
{% block title %}
    <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
    ONTRC
{% endblock %}


{% block MainContents %}
    <h3>主控面板</h3>
    <hr>

    <div class="panel panel-warning">
        <div class="panel-heading">光路模式（测试版）</div>
        <div class="panel-body">
            <div class="row">
                <div class="col-md-2"><strong>光路名称：</strong></div>
                <div class="col-md-2"><strong>OEO:</strong></div>
                <div class="col-md-2"><strong>卡槽:</strong></div>
                <div class="col-md-2"><strong>AWG输入口：</strong></div>
            </div>

            <div class="row">
                <div class="col-md-2">
                    <input type="text" class="form-control"
                           placeholder="Text input" value="***">
                </div>

                <div class="col-md-2">
                    <select class="form-control">
                        <option>OEO#1</option>
                        <option>OEO#2</option>
                    </select>
                </div>

                <div class="col-md-2">
                    <select class="form-control">
                        <option>Card#2</option>
                        <option>Card#4</option>
                        <option>Card#6</option>
                        <option>Card#8</option>
                        <option>Card#10</option>
                        <option>Card#12</option>
                        <option>Card#14</option>
                        <option>Card#16</option>
                    </select>
                </div>

                <div class="col-md-2">
                    <select class="form-control">
                        <option>未设置</option>
                        <option>AWG@1</option>
                        <option>AWG@2</option>
                        <option>AWG@3</option>
                        <option>AWG@4</option>
                    </select>
                </div>

            </div>

            <div class="row" style="margin-top: 20px">
                <div class="col-md-2"><strong>WSS:</strong></div>
                <div class="col-md-2"><strong>WSS接口:</strong></div>
                <div class="col-md-2"><strong>衰减:</strong></div>
                <div class="col-md-2"><strong>波长(点击选择)：</strong></div>
            </div>

            <div class="row">
                <div class="col-md-2">
                    <select class="form-control">
                        <option>未设置</option>
                        <option>WSS#1</option>
                        <option>WSS#2</option>
                        <option>WSS#3</option>
                        <option>WSS#4</option>
                    </select>
                </div>

                <div class="col-md-2">
                    <select class="form-control">
                        <option>未设置</option>
                        <option>PORT@1</option>
                        <option>PORT@2</option>
                        <option>PORT@3</option>
                        <option>PORT@4</option>
                        <option>PORT@5</option>
                        <option>PORT@6</option>
                        <option>PORT@7</option>
                        <option>PORT@8</option>
                        <option>PORT@9</option>
                        <option>屏蔽</option>
                    </select>

                </div>

                <div class="col-md-2">
                    <input type="text" class="form-control"
                           placeholder="Text input" value="0.5 db">
                </div>

                <div class="col-md-2">
                    <button class="btn btn-primary" type="button" data-toggle="collapse"
                            data-target="#collapseExample">
                    未设置
                    </button>
                </div>

                <div class="col-md-2">
                    <button type="button" class="btn btn-danger"
                            id="stopserver">确认设置</button>
                </div>
            </div>

            <!--  这里删掉了波长选择按钮，以后补上来！！！  -->
            <!--  这里删掉了波长选择按钮，以后补上来！！！  -->
            <!--  这里删掉了波长选择按钮，以后补上来！！！  -->
            <!--  这里删掉了波长选择按钮，以后补上来！！！  -->
            <!--  这里删掉了波长选择按钮，以后补上来！！！  -->


        </div> <!-- panel-body-->
    </div> <!-- end panel logging-->


    <div class="panel panel-info">
        <div class="panel-heading">调试模式（测试版）</div>
        <div class="panel-body">

            <div class="row">
                <div class="col-md-2"><strong>OEO:</strong></div>
                <div class="col-md-2"><strong>卡槽:</strong></div>
                <div class="col-md-2"><strong>波长(点击选择)：</strong></div>
            </div>

            <div class="row">

                <div class="col-md-2">
                    <select class="form-control" id="DebugOEOdevice">
                        <option value="1">OEO#1</option>
                        <option value="2">OEO#2</option>
                    </select>
                </div>

                <div class="col-md-2">
                    <select class="form-control" id="DebugOEOslot">
                        <option value="2">Card#2</option>
                        <option value="4">Card#4</option>
                        <option value="6">Card#6</option>
                        <option value="8">Card#8</option>
                        <option value="10">Card#10</option>
                        <option value="12">Card#12</option>
                        <option value="14">Card#14</option>
                        <option value="16">Card#16</option>
                    </select>
                </div>

                <div class="col-md-2">
                    <button class="btn btn-primary" type="button" data-toggle="collapse"
                            data-target="#collapseTESTOEO" id="DebugSetOeoChanel">
                    默认C1
                    </button>
                </div>

                <div class="col-md-2">
                    <button type="button" class="btn btn-danger" id="DebugSetOEO">
                        确认设置</button>
                </div>

                <div class="col-md-2">
                    <button type="button" class="btn btn-success" id="DebugUpdataOEO">
                        同步更新</button>
                </div>

            </div>
            <hr>

            <div class="collapse" id="collapseTESTOEO" style="margin-top: 20px">
                <div class="well">
                    <div class="row">
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C1" value="1">C01</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C2" value="2">C02</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C3" value="3">C03</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C4" value="4">C04</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C5" value="5">C05</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C6" value="6">C06</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C7" value="7">C07</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C8" value="8">C08</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C9" value="9">C09</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C10" value="10">C10</button></div>
                    </div>

                    <div class="row" style="margin-top: 20px">
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C11" value="11">C11</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C12" value="12">C12</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C13" value="13">C13</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C14" value="14">C14</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C15" value="15">C15</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C16" value="16">C16</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C17" value="17">C17</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C18" value="18">C18</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C19" value="19">C19</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C20" value="20">C20</button></div>
                    </div>

                    <div class="row" style="margin-top: 20px">
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C21" value="21">C21</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C22" value="22">C22</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C23" value="23">C23</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C24" value="24">C24</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C25" value="25">C25</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C26" value="26">C26</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C27" value="27">C27</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C28" value="28">C28</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C29" value="29">C29</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C30" value="30">C30</button></div>
                    </div>

                    <div class="row" style="margin-top: 20px">
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C31" value="31">C31</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C32" value="32">C32</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C33" value="33">C33</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C34" value="34">C34</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C35" value="35">C35</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C36" value="36">C36</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C37" value="37">C37</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C38" value="38">C38</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C39" value="39">C39</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C40" value="40">C40</button></div>
                    </div>

                    <div class="row" style="margin-top: 20px">
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C41" value="41">C41</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C42" value="42">C42</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C43" value="43">C43</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C44" value="44">C44</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C45" value="45">C45</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C46" value="46">C46</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C47" value="47">C47</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C48" value="48">C48</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C49" value="49">C49</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C50" value="50">C50</button></div>
                    </div>

                    <div class="row" style="margin-top: 20px">
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C51" value="51">C51</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C52" value="52">C52</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C53" value="53">C53</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C54" value="54">C54</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C55" value="55">C55</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C56" value="56">C56</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C57" value="57">C57</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C58" value="58">C58</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C59" value="59">C59</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C60" value="60">C60</button></div>
                    </div>

                    <div class="row" style="margin-top: 20px">
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C61" value="61">C61</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C62" value="62">C62</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C63" value="63">C63</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C64" value="64">C64</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C65" value="65">C65</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C66" value="66">C66</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C67" value="67">C67</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C68" value="68">C68</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C69" value="69">C69</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C70" value="70">C70</button></div>
                    </div>

                    <div class="row" style="margin-top: 20px">
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C71" value="71">C71</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C72" value="72">C72</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C73" value="73">C73</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C74" value="74">C74</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C75" value="75">C75</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C76" value="76">C76</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C77" value="77">C77</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C78" value="78">C78</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C79" value="79">C79</button></div>
                        <div class="col-md-1"><button type="button" class="btn btn-warning chanelbutton" id="C80" value="80">C80</button></div>
                    </div>
                </div>
            </div>

            <hr>

            <!--  以下显示OEO卡信息  -->
            <h4 style="color: #ff6129">    <strong>OEO#1</strong></h4>
            <table class="table table-striped table-hover">
                <thead> <tr>
                    <th>卡槽</th> <th>波长通道</th> <th>局端链路状态</th>
                    <th>远端链路状态</th>  <th>注册光路</th>
                </tr> </thead>

                <tbody id="tableOEO1"></tbody>
            </table>

            <h4 style="color: #ff6129">    <strong>OEO#2</strong></h4>
            <table class="table table-striped table-hover">
                <thead> <tr>
                    <th>卡槽</th> <th>波长通道</th> <th>局端链路状态</th>
                    <th>远端链路状态</th>  <th>注册光路</th>
                </tr> </thead>

                <tbody id="tableOEO2"></tbody>
            </table>

        </div> <!-- panel-body-->
    </div> <!-- end panel logging-->

{% endblock %}



{% block script %}
    <script>
        var chanel = 1;  //记录全局chanel
        $("#DHTcontrol").addClass("active");

        // 当页面载入之后，读取数据库信息
        $(document).ready(function () {
            LoadOeoCardInfo("1");
            LoadOeoCardInfo("2");
            }
        );

        // 当通道按钮被按下之后
        $(".chanelbutton").click(function () {
            chanel = $(this).val();
            $("#DebugSetOeoChanel").html("C"+chanel);
        });


        // 当OEO 调试部分的按钮被按下之后
        $("#DebugSetOEO").click(function () {
            var oeo = $("#DebugOEOdevice").select().val();
            var slot = $("#DebugOEOslot").select().val();

            $("#DebugSetOEO").attr("disabled","disabled");
            $("#DebugSetOEO").text("Runing...");
            $("#Topinfo2").removeClass("hide");

            $.ajax({
                url: "/ajax_control_setoeo/",
                type: "POST",
                data: {"Device":oeo,"Slot":slot,"Chanel":chanel},
                dataType: "json",
                traditional:true,
                success:function (data) {
                    if(data.data=="SUCCESS")
                        ShowTopInfo1("alert-success","设置成功！");
                    else
                        ShowTopInfo1("alert-danger","设置失败！");


                    $("#DebugSetOEO").removeAttr("disabled");
                    $("#DebugSetOEO").text("确认设置");
                    $("#Topinfo2").addClass("hide");

                    // 刷新页面
                    LoadOeoCardInfo("1");
                    LoadOeoCardInfo("2");
                }
            }); // end ajax

        });


        // 当请求更新数据的时候
        $("#DebugUpdataOEO").click(function () {
            $("#tableOEO1,#tableOEO2").empty();

            $.ajax({
                url: "/ajax_control_updataoeoinfo/",
                type: "POST",
                data: {"Device":"1"},
                dataType: "json",
                traditional:true,
                success:function (data) {
                    console.log(data);
                    // 显示通知
                    ShowTopInfo1("alert-success",data.data);

                    // 刷新页面
                    LoadOeoCardInfo("1");
                    LoadOeoCardInfo("2");
                }
            }); // end ajax

        });

        
        function LoadOeoCardInfo(device) {
            $.ajax({
                url: "/ajax_control_loadoeoinfo/",
                type: "POST",
                data: {"Device":device},
                dataType: "json",
                traditional:true,
                success:function (data) {
                    $("#tableOEO"+device).empty();
                    var count=0;
                    for(;count<data.data.length;count+=5){
                        var addin = '<tr> <th scope="row">'+data.data[count]+
                            '</th> <td>'+data.data[count+1]+
                            '</td> <td>'+data.data[count+2]+
                            '</td> <td>'+data.data[count+3]+
                            '</td> <td>'+data.data[count+4]+
                            '</td> </tr>';
                        $("#tableOEO"+device).append(addin);
                    }
                }
            }); // end ajax
        }
    </script>
{% endblock %}